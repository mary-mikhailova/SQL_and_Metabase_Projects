## Задание

### Необходимо провести многомерный ABC анализ:
- по количеству проданных позиций
- по прибыли с позиции
- по выручке

_Примечание:_ ABC-анализ должен быть представлен одним SQL-запросом.

Пример результирующей таблицы:

| product | amount_abc | profit_abc | revenue_abc |
| ---| --- | --- | --- |
| pr1 | A | C | A |
| pr2 | C | B | B |

Для расчетов вам понадобится таблица _sales_, а именно столбцы:

- dr_kol - кол-во проданного товара в данной строке чека
- dr_ndrugs - название товара
- dr_dat - дата чека
- dr_croz - розничная цена
- dr_czak - закупочная цена
- dr_sdisc - сумма скидки на всю строку чека (даже если dr_kol 1, вычитать сумму скидки нужно со строки чека, а не с каждой проданной позиции)

Обратите внимание на способ расчета каждой из метрик:

- выручка = кол-во проданных позиций * розничную цену - скидка
- прибыль = кол-во проданных позиций * (розница - закупка) - скидка

### Необходимо провести XYZ анализ ассортимента

Итоговая таблица, после совмещения ABC и XYZ должна выглядеть так:

| product | amount_abc | profit_abc | revenue_abc | xyz_sales |
| ---| --- | --- | --- | --- |
| pr1 | A | C | A | X |
| pr2 | C | B | B | Z |

_Примечание:_ корректные границы диапазонов — 0-10% — группа X, >25% — Z, все остальное — Y.
В качестве периодов для расчета берите недельные продажи. Чтобы определить группу товара, должно быть минимум 4 продажи этого товара в разные недели.
Например, если товар продавался 7 раз, но все в период и 10 по 15 марта 2022 года, то расчитать XYZ-группу мы не можем. 
А если он продался 4 раза, но все продажи были сделаны в разные недели, то определить группу мы сможем.

Обращаем внимание, что обычно в XYZ-анализе в качестве временных отрезков берут квартал или полугодие, чтобы лучше прослеживалась сезонность. 
Однако, коллеги из аптеки дали нам не очень много данных из своей базы, поэтому возьмем за ориентир неделю.
Но если вдруг такая задача возникнет на работе - имейте ввиду, берите за основу большой промежуток времени.

Соответственно, если группу для данного товара определить не получилось, то в итоговой таблице там просто должен стоять NULL. 
Обязательно проверьте, чтобы при объединении результатов XYZ и ABC анализа у вас не потерялись эти строки!

__Структура БД:__

<img width="889" height="466" alt="image" src="https://github.com/user-attachments/assets/915b3976-0d56-4aa4-af5f-35c04200ecdc" />



